Sort_269                                                          0.00               root                                                                                                                                                                            Column#328:desc
└─Projection_271                                              0.00               root                                                                                                                                                                            gharchive_dev.github_repos.repo_id, gharchive_dev.github_repos.repo_name, gharchive_dev.github_repos.primary_language, gharchive_dev.github_repos.description, Column#326, Column#327, Column#437, Column#480, Column#328, Column#375, Column#394
  └─HashJoin_273                                              0.00               root                                                                                                                                                                            left outer join, equal:[eq(gharchive_dev.github_repos.repo_id, gharchive_dev.github_events.repo_id)]
    ├─HashJoin_275(Build)                                     0.00               root                                                                                                                                                                            left outer join, equal:[eq(gharchive_dev.github_repos.repo_id, gharchive_dev.github_events.repo_id)]
    │ ├─HashJoin_277(Build)                                 0.00               root                                                                                                                                                                            left outer join, equal:[eq(gharchive_dev.github_repos.repo_id, gharchive_dev.github_repos.repo_id)]
    │ │ ├─HashJoin_279(Build)                             0.00               root                                                                                                                                                                            left outer join, equal:[eq(gharchive_dev.github_repos.repo_id, gharchive_dev.github_events.repo_id)]
    │ │ │ ├─CTEFullScan_336(Build)                      0.00               root              CTE:toprepos AS tr                                                                                                                                            data:CTE_2
    │ │ │ └─Projection_281(Probe)                       14.57              root                                                                                                                                                                            gharchive_dev.github_events.repo_id, substring_index(Column#374, ,, 5)->Column#375
    │ │ │   └─StreamAgg_283                             14.57              root                                                                                                                                                                            group by:gharchive_dev.github_events.repo_id, funcs:group_concat(distinct gharchive_dev.github_events.actor_login order by Column#373 desc separator ",")->Column#374, funcs:firstrow(gharchive_dev.github_events.repo_id)->gharchive_dev.github_events.repo_id
    │ │ │     └─Sort_334                                14.57              root                                                                                                                                                                            gharchive_dev.github_events.repo_id, Column#373:desc
    │ │ │       └─HashAgg_286                           14.57              root                                                                                                                                                                            group by:gharchive_dev.github_events.actor_login, gharchive_dev.github_events.repo_id, funcs:count(1)->Column#373, funcs:firstrow(gharchive_dev.github_events.repo_id)->gharchive_dev.github_events.repo_id, funcs:firstrow(gharchive_dev.github_events.actor_login)->gharchive_dev.github_events.actor_login
    │ │ │         └─IndexJoin_290                       14.57              root                                                                                                                                                                            anti semi join, inner:IndexReader_289, outer key:gharchive_dev.github_events.actor_login, inner key:gharchive_dev.blacklist_users.login, equal cond:eq(gharchive_dev.github_events.actor_login, gharchive_dev.blacklist_users.login)
    │ │ │           ├─IndexJoin_305(Build)              18.21              root                                                                                                                                                                            inner join, inner:IndexLookUp_304, outer key:gharchive_dev.github_repos.repo_id, inner key:gharchive_dev.github_events.repo_id, equal cond:eq(gharchive_dev.github_repos.repo_id, gharchive_dev.github_events.repo_id)
    │ │ │           │ ├─HashAgg_310(Build)            1.00               root                                                                                                                                                                            group by:gharchive_dev.github_repos.repo_id, funcs:firstrow(gharchive_dev.github_repos.repo_id)->gharchive_dev.github_repos.repo_id
    │ │ │           │ │ └─Selection_311             0.00               root                                                                                                                                                                            not(isnull(gharchive_dev.github_repos.repo_id))
    │ │ │           │ │   └─CTEFullScan_312         0.00               root              CTE:toprepos AS tr                                                                                                                                            data:CTE_2
    │ │ │           │ └─IndexLookUp_304(Probe)        18.21              root              partition:push_event,pull_request_event,issues_event,pull_request_review_event                                                                                
    │ │ │           │   ├─Selection_302(Build)        358.82             cop[tikv]                                                                                                                                                                       not(like(gharchive_dev.github_events.actor_login, "%bot%", 92)), or(or(and(eq(gharchive_dev.github_events.type, "PullRequestEvent"), eq(gharchive_dev.github_events.action, "opened")), and(eq(gharchive_dev.github_events.type, "IssuesEvent"), eq(gharchive_dev.github_events.action, "opened"))), or(and(eq(gharchive_dev.github_events.type, "PullRequestReviewEvent"), eq(gharchive_dev.github_events.action, "created")), and(eq(gharchive_dev.github_events.type, "PushEvent"), eq(gharchive_dev.github_events.action, ""))))
    │ │ │           │   │ └─IndexRangeScan_300      1171.57            cop[tikv]         table:ge, index:index_github_events_on_repo_id_type_action_month_actor_login(repo_id, type, action, event_month, actor_login)                                 range: decided by [eq(gharchive_dev.github_events.repo_id, gharchive_dev.github_repos.repo_id) or(or(eq(gharchive_dev.github_events.type, PullRequestEvent), eq(gharchive_dev.github_events.type, IssuesEvent)), or(eq(gharchive_dev.github_events.type, PullRequestReviewEvent), eq(gharchive_dev.github_events.type, PushEvent)))], keep order:false
    │ │ │           │   └─Selection_303(Probe)        18.21              cop[tikv]                                                                                                                                                                       ge(gharchive_dev.github_events.created_at, 2022-07-28 17:51:53), le(gharchive_dev.github_events.created_at, 2022-10-28 17:51:53)
    │ │ │           │     └─TableRowIDScan_301        358.82             cop[tikv]         table:ge                                                                                                                                                      keep order:false
    │ │ │           └─IndexReader_289(Probe)            18.21              root                                                                                                                                                                            index:IndexRangeScan_288
    │ │ │             └─IndexRangeScan_288              18.21              cop[tikv]         table:bu, index:blacklist_users_login_uindex(login)                                                                                                           range: decided by [eq(gharchive_dev.blacklist_users.login, gharchive_dev.github_events.actor_login)], keep order:false, stats:pseudo
    │ │ └─HashAgg_337(Probe)                              1.00               root                                                                                                                                                                            group by:gharchive_dev.github_repos.repo_id, funcs:group_concat(distinct gharchive_dev.collections.name separator ",")->Column#394, funcs:firstrow(gharchive_dev.github_repos.repo_id)->gharchive_dev.github_repos.repo_id
    │ │   └─IndexJoin_345                                 0.00               root                                                                                                                                                                            inner join, inner:TableReader_341, outer key:gharchive_dev.collection_items.collection_id, inner key:gharchive_dev.collections.id, equal cond:eq(gharchive_dev.collection_items.collection_id, gharchive_dev.collections.id)
    │ │     ├─HashJoin_353(Build)                         0.00               root                                                                                                                                                                            inner join, equal:[eq(gharchive_dev.github_repos.repo_name, gharchive_dev.collection_items.repo_name)]
    │ │     │ ├─Selection_354(Build)                    0.00               root                                                                                                                                                                            not(isnull(gharchive_dev.github_repos.repo_id)), not(isnull(gharchive_dev.github_repos.repo_name))
    │ │     │ │ └─CTEFullScan_355                     0.00               root              CTE:toprepos AS tr                                                                                                                                            data:CTE_2
    │ │     │ └─TableReader_358(Probe)                  9990.00            root                                                                                                                                                                            data:Selection_357
    │ │     │   └─Selection_357                         9990.00            cop[tikv]                                                                                                                                                                       not(isnull(gharchive_dev.collection_items.collection_id))
    │ │     │     └─TableFullScan_356                   10000.00           cop[tikv]         table:ci                                                                                                                                                      keep order:false, stats:pseudo
    │ │     └─TableReader_341(Probe)                      0.00               root                                                                                                                                                                            data:Selection_340
    │ │       └─Selection_340                             0.00               cop[tikv]                                                                                                                                                                       eq(gharchive_dev.collections.public, 1)
    │ │         └─TableRangeScan_339                      0.00               cop[tikv]         table:c                                                                                                                                                       range: decided by [gharchive_dev.collection_items.collection_id], keep order:false, stats:pseudo
    │ └─HashAgg_365(Probe)                                  1.00               root                                                                                                                                                                            group by:gharchive_dev.github_events.repo_id, funcs:count(1)->Column#437, funcs:firstrow(gharchive_dev.github_events.repo_id)->gharchive_dev.github_events.repo_id
    │   └─IndexJoin_375                                     0.00               root                                                                                                                                                                            inner join, inner:IndexLookUp_374, outer key:gharchive_dev.github_repos.repo_id, inner key:gharchive_dev.github_events.repo_id, equal cond:eq(gharchive_dev.github_repos.repo_id, gharchive_dev.github_events.repo_id)
    │     ├─Selection_380(Build)                            0.00               root                                                                                                                                                                            not(isnull(gharchive_dev.github_repos.repo_id))
    │     │ └─CTEFullScan_381                             0.00               root              CTE:toprepos AS tr                                                                                                                                            data:CTE_2
    │     └─IndexLookUp_374(Probe)                          0.00               root              partition:pull_request_event                                                                                                                                  
    │       ├─IndexRangeScan_371(Build)                     0.00               cop[tikv]         table:ge, index:index_ge_on_repo_id_type_action_created_at_number_pdsize_psize(repo_id, type, action, created_at, number, push_distinct_size, push_size)      range: decided by [eq(gharchive_dev.github_events.repo_id, gharchive_dev.github_repos.repo_id) eq(gharchive_dev.github_events.type, PullRequestEvent) eq(gharchive_dev.github_events.action, opened) ge(gharchive_dev.github_events.created_at, 2022-07-28 17:51:53) le(gharchive_dev.github_events.created_at, 2022-10-28 17:51:53)], keep order:false
    │       └─Selection_373(Probe)                          0.00               cop[tikv]                                                                                                                                                                       not(like(gharchive_dev.github_events.actor_login, "%[bot]", 92))
    │         └─TableRowIDScan_372                          0.00               cop[tikv]         table:ge                                                                                                                                                      keep order:false
    └─HashAgg_396(Probe)                                      1.00               root                                                                                                                                                                            group by:gharchive_dev.github_events.repo_id, funcs:count(1)->Column#480, funcs:firstrow(gharchive_dev.github_events.repo_id)->gharchive_dev.github_events.repo_id
      └─IndexJoin_407                                         0.00               root                                                                                                                                                                            inner join, inner:IndexLookUp_406, outer key:gharchive_dev.github_repos.repo_id, inner key:gharchive_dev.github_events.repo_id, equal cond:eq(gharchive_dev.github_repos.repo_id, gharchive_dev.github_events.repo_id)
        ├─Selection_412(Build)                                0.00               root                                                                                                                                                                            not(isnull(gharchive_dev.github_repos.repo_id))
        │ └─CTEFullScan_413                                 0.00               root              CTE:toprepos AS tr                                                                                                                                            data:CTE_2
        └─IndexLookUp_406(Probe)                              0.00               root              partition:push_event                                                                                                                                          
          ├─Selection_404(Build)                              0.00               cop[tikv]                                                                                                                                                                       not(like(gharchive_dev.github_events.actor_login, "%[bot]", 92))
          │ └─IndexRangeScan_402                            0.00               cop[tikv]         table:ge, index:index_github_events_on_repo_id_type_action_month_actor_login(repo_id, type, action, event_month, actor_login)                                 range: decided by [eq(gharchive_dev.github_events.repo_id, gharchive_dev.github_repos.repo_id) eq(gharchive_dev.github_events.type, PushEvent)], keep order:false
          └─Selection_405(Probe)                              0.00               cop[tikv]                                                                                                                                                                       ge(gharchive_dev.github_events.created_at, 2022-07-28 17:51:53), le(gharchive_dev.github_events.created_at, 2022-10-28 17:51:53)
            └─TableRowIDScan_403                              0.00               cop[tikv]         table:ge                                                                                                                                                      keep order:false
CTE_2                                                             0.00               root                                                                                                                                                                            Non-Recursive CTE
└─Selection_130(Seed Part)                                    0.00               root                                                                                                                                                                            or(or(1, not(isnull(gharchive_dev.github_repos.repo_id))), or(and(not(isnull(gharchive_dev.github_repos.repo_name)), not(isnull(gharchive_dev.github_repos.repo_id))), or(not(isnull(gharchive_dev.github_repos.repo_id)), not(isnull(gharchive_dev.github_repos.repo_id)))))
  └─Projection_131                                            0.00               root                                                                                                                                                                            gharchive_dev.github_repos.repo_id, gharchive_dev.github_repos.repo_name, gharchive_dev.github_repos.primary_language, gharchive_dev.github_repos.description, Column#131, ifnull(Column#171, 0)->Column#177, Column#176
    └─Projection_132                                          0.00               root                                                                                                                                                                            cast(plus(plus(Column#133, ifnull(Column#173, 0)), mul(abs(div(1, cast(plus(1, timestampdiff(YEAR, gharchive_dev.github_repos.created_at, 2022-10-28 17:51:53)), decimal(20,0) BINARY))), 200)), decimal(65,4) BINARY)->Column#176, gharchive_dev.github_repos.repo_id, gharchive_dev.github_repos.repo_name, gharchive_dev.github_repos.description, gharchive_dev.github_repos.primary_language, Column#131, Column#171
      └─Projection_259                                        0.00               root                                                                                                                                                                            gharchive_dev.github_repos.repo_id, gharchive_dev.github_repos.repo_name, gharchive_dev.github_repos.description, gharchive_dev.github_repos.primary_language, gharchive_dev.github_repos.created_at, Column#131, Column#133, Column#171, Column#173
        └─TopN_135                                            0.00               root                                                                                                                                                                            Column#533:desc, offset:0, count:100
          └─Projection_260                                    0.00               root                                                                                                                                                                            gharchive_dev.github_repos.repo_id, gharchive_dev.github_repos.repo_name, gharchive_dev.github_repos.description, gharchive_dev.github_repos.primary_language, gharchive_dev.github_repos.created_at, Column#131, Column#133, Column#171, Column#173, cast(plus(plus(Column#133, ifnull(Column#173, 0)), mul(abs(div(1, cast(plus(1, timestampdiff(YEAR, gharchive_dev.github_repos.created_at, 2022-10-28 17:51:53)), decimal(20,0) BINARY))), 200)), decimal(65,4) BINARY)->Column#533
            └─HashJoin_137                                    0.00               root                                                                                                                                                                            CARTESIAN anti semi join, other cond:eq(gharchive_dev.github_repos.repo_name, gharchive_dev.blacklist_repos.name)
              ├─TableReader_256(Build)                        10000.00           root                                                                                                                                                                            data:TableFullScan_255
              │ └─TableFullScan_255                         10000.00           cop[tikv]         table:blacklist_repos                                                                                                                                         keep order:false, stats:pseudo
              └─HashJoin_143(Probe)                           0.00               root                                                                                                                                                                            left outer join, equal:[eq(gharchive_dev.github_repos.repo_id, gharchive_dev.github_events.repo_id)]
                ├─HashJoin_190(Build)                         0.00               root                                                                                                                                                                            inner join, equal:[eq(gharchive_dev.github_repos.repo_id, gharchive_dev.github_events.repo_id)]
                │ ├─TableReader_217(Build)                  0.00               root                                                                                                                                                                            data:Selection_216
                │ │ └─Selection_216                       0.00               cop[tiflash]                                                                                                                                                                    eq(gharchive_dev.github_repos.is_deleted, 0), eq(gharchive_dev.github_repos.primary_language, "C#"), gt(gharchive_dev.github_repos.forks, 5), gt(gharchive_dev.github_repos.pushed_at, 2022-07-28 17:51:53), gt(gharchive_dev.github_repos.stars, 5), lt(gharchive_dev.github_repos.created_at, 2022-10-27 17:51:53), lt(gharchive_dev.github_repos.stars, 50000), not(like(lower(gharchive_dev.github_repos.repo_name), "%fuck%", 92))
                │ │   └─TableFullScan_215                 10000.00           cop[tiflash]      table:r                                                                                                                                                       keep order:false, stats:pseudo
                │ └─Selection_191(Probe)                    745289.04          root                                                                                                                                                                            gt(cast(Column#132, decimal(20,0) BINARY), mul(0.9, cast(Column#131, decimal(20,0) BINARY)))
                │   └─HashAgg_193                           931611.30          root                                                                                                                                                                            group by:Column#528, funcs:count(1)->Column#131, funcs:count(distinct Column#525)->Column#132, funcs:sum(Column#526)->Column#133, funcs:firstrow(Column#527)->gharchive_dev.github_events.repo_id
                │     └─Projection_257                      16967295.85        root                                                                                                                                                                            gharchive_dev.github_events.actor_id, greatest(least(mul(div(cast(timestampdiff(SECOND, 2022-07-28 17:51:53, gharchive_dev.github_events.created_at), decimal(20,0) BINARY), 7948800), 3), 5), 2)->Column#526, gharchive_dev.github_events.repo_id, gharchive_dev.github_events.repo_id
                │       └─TableReader_203                   16967295.85        root              partition:watch_event                                                                                                                                         data:Selection_202
                │         └─Selection_202                   16967295.85        cop[tiflash]                                                                                                                                                                    eq(gharchive_dev.github_events.type, "WatchEvent"), ge(gharchive_dev.github_events.created_at, 2022-07-28 17:51:53), le(gharchive_dev.github_events.created_at, 2022-10-28 17:51:53)
                │           └─TableFullScan_201             5182176410.00      cop[tiflash]      table:ge                                                                                                                                                      keep order:false
                └─Selection_229(Probe)                        269238.35          root                                                                                                                                                                            gt(cast(Column#172, decimal(20,0) BINARY), mul(0.9, cast(Column#171, decimal(20,0) BINARY)))
                  └─HashAgg_231                               336547.93          root                                                                                                                                                                            group by:Column#532, funcs:count(1)->Column#171, funcs:count(distinct Column#529)->Column#172, funcs:sum(Column#530)->Column#173, funcs:firstrow(Column#531)->gharchive_dev.github_events.repo_id
                    └─Projection_258                          6129496.66         root                                                                                                                                                                            gharchive_dev.github_events.actor_id, greatest(least(mul(div(cast(timestampdiff(SECOND, 2022-07-28 17:51:53, gharchive_dev.github_events.created_at), decimal(20,0) BINARY), 7948800), 3), 4), 1)->Column#530, gharchive_dev.github_events.repo_id, gharchive_dev.github_events.repo_id
                      └─TableReader_241                       6129496.66         root              partition:fork_event                                                                                                                                          data:Selection_240
                        └─Selection_240                       6129496.66         cop[tiflash]                                                                                                                                                                    eq(gharchive_dev.github_events.type, "ForkEvent"), ge(gharchive_dev.github_events.created_at, 2022-07-28 17:51:53), le(gharchive_dev.github_events.created_at, 2022-10-28 17:51:53)
                          └─TableFullScan_239                 5182176410.00      cop[tiflash]      table:ge                                                                                                                                                      keep order:false